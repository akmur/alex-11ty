
<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Setup an Ubuntu VPS the way I like it</title>
    <link href="https://fonts.googleapis.com/css?family=Merriweather:700|Muli:300,700" rel="stylesheet">
    <link href="https://unpkg.com/prismjs@1.20.0/themes/prism-okaidia.css" rel="stylesheet">
    <link rel="stylesheet" href="/css/index.css">
  </head>
  <body class="ui-dark">
    <div class="wrapper">
      <div class="layout">
        <div class="header">
          <a class="logo" href="/"><svg class="logo__triangle logo__triangle--left" style="isolation: isolate;" viewbox="217 167 106 96">
          <path d="M220 260l50-90 50 90H220z" vector-effect="non-scaling-stroke"></path></svg> <svg class="logo__triangle logo__triangle--center" style="isolation: isolate;" viewbox="217 167 106 96">
          <path d="M220 260l50-90 50 90H220z" vector-effect="non-scaling-stroke"></path></svg> <svg class="logo__triangle logo__triangle--right" style="isolation: isolate;" viewbox="217 167 106 96">
          <path d="M220 260l50-90 50 90H220z" vector-effect="non-scaling-stroke"></path></svg></a>
          <div id="nav">
            <div class="menu-my-menu-container">
              <ul class="menu" id="menu-my-menu">
                <li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-home menu-item-1408" id="menu-item-1408">
                  <a href="/">Home</a>
                </li>
                <li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-1409" id="menu-item-1409">
                  <a href="/posts/">Posts</a>
                </li>
                <li class="menu-item menu-item-type-post_type menu-item-object-page current-menu-item page_item page-item-6 current_page_item menu-item-1411" id="menu-item-1411">
                  <a href="/about/">About</a>
                </li>
              </ul>
            </div>
          </div>
        </div>
        <div class="main">
          <p>In this post I want to document my way of installing a LAMP stack plus Ruby on Rails on my Ubuntu VPS.</p>
<p>VPS stands for Virtual Private Server, and it‚Äôs like having a real remote machine you can log into to configure it the way you like (and need) it, and serve your web pages to people around the world.</p>
<p>My installation includes:</p>
<ul>
<li>MySQL</li>
<li>RVM</li>
<li>Ruby</li>
<li>Rails</li>
<li>Passenger with¬†Apache module</li>
<li>PHP</li>
<li>PhpMyAdmin</li>
</ul>
<p>This procedure is tested both on Ubuntu 10.04 and Ubuntu 12.04.
Be advised that right now 1024 MB of RAM is the minimum recommended specs for a Passenger (with¬†Apache module) installation.
I chose Apache/MySQL over the trendy and possibly superior Nginx/Postgresql, because by using the tried and tested Apache/MySQL solution, I could go ahead with a painless installation of the PhpMyAdmin tool, and both Apache and MySQL have a ton of documentation.</p>
<p>Let‚Äôs get this started!</p>
<p>Ah, wait, just a note for all n00bs out there. The ‚Äú$‚Äù symbol means ‚Äúyour command prompt‚Äù in the terminal. So you don‚Äôt have to type it, it‚Äôs just there to signal that we‚Äôre in the terminal and have to type a command in there. Yes? Cool.</p>
<p><strong>Upgrading the VPS</strong></p>
<p>First of all, we should login though ssh into our VPS.</p>
<pre>$ ssh root@your-ip-address</pre>
<p>once we are in, let‚Äôs do some updating</p>
<pre>$ apt-get update
$ apt-get upgrade</pre>
<p>Finally, a nice reboot</p>
<pre>$ reboot</pre>
<p>Now, we‚Äôve been kicked out. Let‚Äôs log back in, like this:</p>
<pre>$ ssh root@your-ip-address</pre>
<p>and let‚Äôs proceed by creating a new user which we‚Äôll use from now on to log into our sweet server. We‚Äôll be prompted to choose a password for our user.
Also, let‚Äôs add our user to the sudoers list (meaning our user can get superpowers whenever he wants). Then, we exit.</p>
<pre>$ adduser alex
$ adduser alex sudo
$ exit</pre>
<p>We‚Äôre now ready to log back in, this time with our own user, and let‚Äôs start installing some stuff which we‚Äôll need during our installations.</p>
<pre>$ ssh alex@your-ip-address
$ sudo apt-get install nano git-core curl libcurl4-openssl-dev apache2-prefork-dev libapr1-dev libaprutil1-dev</pre>
<p><strong>Let‚Äôs now install RVM.</strong></p>
<p>RVM is a tool that will allow us to manage the installation of ruby.</p>
<pre>$ curl -L get.rvm.io | bash -s stable --auto</pre>
<p>Then let‚Äôs load the rvm paths to .bashrc, type:</p>
<pre>$ sudo nano .bashrc</pre>
<p>and then add this line to the bottom of the file</p>
<pre>[[ -s "$HOME/.rvm/scripts/rvm" ]] && . "$HOME/.rvm/scripts/rvm"</pre>
<p>You can save with ctrl-o and exit with ctrl-x.</p>
<p>To load RVM in our current session, type the following in terminal</p>
<pre>source .bashrc</pre>
<p>if any issue should arise, add ‚Äúsource .profile‚Äù to the files .bash_profile or .bashrc.</p>
<p>To check if RVM was properly installed, type:</p>
<pre>$ type rvm | head -1</pre>
<p>You should get the text:</p>
<pre>rvm is a function</pre>
<p>Now we can go on and install ruby and rails and so on.</p>
<p>Type in terminal:</p>
<pre>$ rvm notes
$ rvm autolibs enable
$ rvm requirements</pre>
<p>The last command will either install the required packages, or tell you what packages to install through sudo apt-get install.
In any case, after the installation of the needed libraries, let‚Äôs go ahead and install Ruby.</p>
<p><strong>Ruby and(on) Rails installation</strong></p>
<pre>$ rvm install 1.9.3
$ rvm --default use 1.9.3</pre>
<p>Then to check if ruby is doing fine:</p>
<pre>$ ruby -v</pre>
<p>Now, let‚Äôs install rails:</p>
<pre>$ gem install rails</pre>
<p><strong>Passenger and Apache installation</strong></p>
<p>Let‚Äôs install passenger, to serve our Rails apps on our server.</p>
<pre>$ gem install passenger</pre>
<p>Go with the default options and you should be fine.
To check if it‚Äôs properly installed:</p>
<pre>$ passenger -v</pre>
<p>Now, we can install Apache support for Passenger.</p>
<pre>$ rvmsudo passenger-install-apache2-module</pre>
<p>Once finished, you should get a message like this:</p>
<pre>Please edit your Apache configuration file, and add these lines:

   LoadModule passenger_module /home/alex/.rvm/gems/ruby-1.9.3-p392/gems/passenger-3.0.19/ext/apache2/mod_passenger.so
   PassengerRoot /home/alex/.rvm/gems/ruby-1.9.3-p392/gems/passenger-3.0.19
   PassengerRuby /home/alex/.rvm/wrappers/ruby-1.9.3-p392/ruby</pre>
<p>So let‚Äôs do like it says, and let‚Äôs add those lines to Apache configuration.</p>
<p>How to find where is the Apache configuration? Well I could tell you right away, but let‚Äôs find out.</p>
<p>run the command:</p>
<pre>$ ps -ef | grep apache</pre>
<p>which will return:</p>
<pre>root 1419 1  0 Apr10 ? 00:00:00 /usr/sbin/apache2 -k start</pre>
<p>The important part is /usr/sbin/apache2 (or whatever you might have in its place), so just run:</p>
<pre>$ /usr/sbin/apache2 -V</pre>
<p>It will tell us something like:</p>
<pre>-D SERVER_CONFIG_FILE="/etc/apache2/apache2.conf"</pre>
<p>So that‚Äôs where the config file is stored. Open it with:</p>
<pre>$ sudo nano /etc/apache2/apache2.conf</pre>
<p>and add the lines we mentioned above (actally, don‚Äôt copy them from here, as they might be slightly different in your case)</p>
<pre>LoadModule passenger_module /home/alex/.rvm/gems/ruby-1.9.3-p392/gems/passenger-3.0.19/ext/apache2/mod_passenger.so
PassengerRoot /home/alex/.rvm/gems/ruby-1.9.3-p392/gems/passenger-3.0.19
PassengerRuby /home/alex/.rvm/wrappers/ruby-1.9.3-p392/ruby</pre>
<p>Then, restart the server</p>
<pre>$ sudo /etc/init.d/apache2 restart</pre>
<p>At some point, Passenger will also tell us about how to change the Apache configuration to host our apps, a useful snippet of information actually, here it is for future reference.</p>
<pre>Suppose you have a Rails application in /somewhere. Add a virtual host to your
Apache configuration file and set its DocumentRoot to /somewhere/public:


      ServerName www.yourhost.com
      # !!! Be sure to point DocumentRoot to 'public'!
      DocumentRoot /somewhere/public

         # This relaxes Apache security settings.
         AllowOverride all
         # MultiViews must be turned off.
         Options -MultiViews


</pre>
<p>Let‚Äôs type in terminal:</p>
<pre>sudo apt-get install mysql-server mysql-client
sudo apt-get install php5
sudo apt-get install phpmyadmin</pre>
<p>MySql will require you to choose a master password, so choose one when prompted.
PhpMyAdmin will also prompt you to choose some options (choose the default) and a password (choose whatever you like), plus the MySql password you chose above‚Ä¶ to make it easier, I choose them to be the same üôÇ</p>
<p>To test that our php is working, create a file using nano editor, like so:</p>
<pre>$ sudo nano /var/www/phpinfo.php</pre>
<p>and in the file, write:</p>
<pre></pre>
<p>Now visit the page, typing something like this (example Ip address, replace with yours) in your browser address bar: 102.192.194.195/phpinfo.php. It should work, hopefully. If it does, try your luck with ¬†your-ip-address-here/phpmyadmin, again it should work. In case it does not and you get a ‚ÄúPage not found‚Äù kind of error, it‚Äôs because we have to tell Apache where to find PhpMyAdmin, so this should be fixed by the following command, which copies a configuration from PhpMyAdmin to Apache itself.</p>
<pre>$ sudo cp /etc/phpmyadmin/apache.conf /etc/apache2/conf.d</pre>
<p>now restart ap√®ache, try again with your-ip-address-here/phpmyadmin, it should work!<!--54b7243ad41cf1421288506--></p>
<div style="display:none;">
  <a href="http://www.topodin.com/seo/post/SEO-prodvizhenie-sayta-v-Google">—Ä–∞—Å–∫—Ä—É—Ç–∫–∞ —Å–∞–π—Ç–æ–≤</a>
</div>
<!--/54b7243ad41cf1421288506-->
<!--54b7243ad41cf1421288506-->
<div style="display:none;">
  <a href="https://topodin.com/seo/post/effektivnaya-reklama-v-sotsialnyh-setyah">—Ä–∞—Å–∫—Ä—É—Ç–∫–∞ —Å–∞–π—Ç–∞ —á–µ—Ä–µ–∑ —Å–æ—Ü–∏–∞–ª—å–Ω—ã–µ —Å–µ—Ç–∏</a>
</div>
<!--/54b7243ad41cf1421288506-->
<!--54b7243ad41cf1421288506-->
<div style="display:none;">
  <a href="https://topodin.com/seo/post/prodvizhenie-internet-magazina">—Ä–µ–∫–ª–∞–º–∞ –≤ –º–µ—Ç—Ä–æ —Å–ø–±</a>
</div>
<!--/54b7243ad41cf1421288506-->
<!--54cd9b6444c531422760804-->
<div style="display:none;">
  <a href="http://www.one-escort.com/Montreal_escort.php">sexy escort</a>
</div>
<!--/54cd9b6444c531422760804-->
<!--54cd9b6444c531422760804-->
<div style="display:none;">
  <a href="http://www.one-escort.com/Paris_escort.php">Paris escorts high class</a>
</div>
<!--/54cd9b6444c531422760804-->
<!--54cd9b6444c531422760804-->
<div style="display:none;">
  <a href="http://iphone6casesandcovers.com/alfa-bank-kreditnaya-karti-2.php">—ç–∫—Å–ø—Ä–µ—Å—Å –∫—Ä–µ–¥–∏—Ç 30000</a>
</div>
<!--/54cd9b6444c531422760804-->

        </div>
        <footer class="footer">
          <div class="footer__container">
            <p class="footer__text">Find me on:<br>
              <a class="footer__link" href="https://twitter.com/akmur">Twitter</a>,
              <a rel="me" href="https://mastodon.social/@akmur" class="footer__link">Mastodon</a>, <a class="footer__link" href="https://www.linkedin.com/in/alessandromuraro/">LinkedIn</a>, <a class="footer__link" href="https://github.com/akmur">Github</a>.
            </p>
          </div>
        </footer>
      </div>
    </div>
  </body>
</html>